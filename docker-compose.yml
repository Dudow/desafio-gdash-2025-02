services:
  rabbitmq:
    image: rabbitmq:4-management
    container_name: gdash_rabbitmq
    ports:
      - "5672:5672"
      - "15672:15672"
    environment:
      RABBITMQ_DEFAULT_USER: teste
      RABBITMQ_DEFAULT_PASS: senha

  producer:
    build:
      context: ./python-producer
      dockerfile: Dockerfile
    container_name: gdash_producer
    depends_on:
      - rabbitmq
    environment:
      LAT: -23.55
      LON: -46.63
      LOCATION_NAME: "SÃ£o Paulo - SP"
      QUEUE_NAME: "weather_queue"
      RABBIT_URL: "amqp://teste:senha@rabbitmq:5672"
      # TO DO: PASS IT TO 3600
      INTERVAL: 5
    restart: always
    tty: true
    stdin_open: true

  worker:
    build:
      context: ./go-worker
      dockerfile: Dockerfile
    container_name: gdash_worker
    depends_on:
      - rabbitmq
    environment:
      QUEUE_NAME: "weather_queue"
      RABBIT_URL: "amqp://teste:senha@rabbitmq:5672"
    restart: unless-stopped

  mongodb:
    image: mongo:latest
    container_name: mongodb
    restart: always
    ports:
      - 27017:27017
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: 12345
    volumes:
      - mongodb_data:/data/db

volumes:
  mongodb_data:
